package com.rest.service;

import java.util.HashMap;
import java.util.Map;

import javax.ws.rs.core.Response;
import javax.ws.rs.ext.Provider;
@Provider
public class SecureService implements ISecureService {

	public static Map tokenMap = new HashMap();
	@Override
	public Response authenticate(Credentials credentials) {
		String token="";
		try{
			if(credentials.getUsername().equalsIgnoreCase("santosh")){
				token=issueToken(credentials.getUsername());
				tokenMap.put(token, credentials.getUsername());
			}
		}catch(Exception e){
			
		}
		return Response.ok(token).build();
	}
	
	public String issueToken(String userName){
		
		
		/*Random random = new SecureRandom();
	    String token = new BigInteger(130, random).toString(32); */
		return JWTokenUtil.buildJWT(userName);
	}

	@Override
	public Response saveData(Credentials credentials) {
		// TODO Auto-generated method stub
		return Response.ok("SUCCESSFULL").build();
	}

}
